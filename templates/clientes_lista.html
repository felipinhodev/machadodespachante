{% extends "base.html" %}

{% block title %}Lista de Clientes{% endblock %}

{% block content %}
<style>
    /* Container */
    .content-container { max-width: 1100px; margin: auto; }

    /* Header */
    .header-actions { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; }
    .header-actions h2 { margin: 0; font-size: 1.8em; }
    .header-actions a.btn { font-weight: 500; }

    /* Alerts */
    .alert { border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }

    /* Table */
    .table-responsive { overflow-x: auto; max-height: 500px; }
    .compact-table th, .compact-table td { padding: 8px; font-size: 0.9em; white-space: nowrap; }
    /* Remove destaque do hover */
    .table-hover tbody tr:hover { background-color: inherit; }

    /* Action Buttons in Table */
    .table-actions a { margin-right: 5px; }

    /* Responsive Filters - if added later */
    .filters { display: flex; flex-wrap: wrap; gap: 15px; align-items: flex-end; padding: 15px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 20px; }
    .filter-group { display: flex; flex-direction: column; }
    .filters label { font-weight: 600; margin-bottom: 5px; }
    .filters .form-control, .filters .form-select { min-width: 150px; max-width: 250px; }
</style>

<div class="content-container">
    <div class="header-actions">
        <h2>Lista de Clientes Cadastrados</h2>
        <a href="{{ url_for('cliente_cadastro') }}" class="btn btn-primary">
            <i class="fas fa-plus-circle"></i> Novo Cliente
        </a>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ 'danger' if category == 'error' else 'success' }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    {% if clientes %}
    <div class="table-responsive">
        <table class="table table-striped table-hover compact-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>CPF/CNPJ</th>
                    <th>Telefone</th>
                    <th>E-mail</th>
                    <th>Data Cadastro</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% for cliente in clientes %}
                <tr>
                    <td>{{ cliente.id }}</td>
                    <td>{{ cliente.nome }}</td>
                    <td>{{ cliente.cpf_cnpj }}</td>
                    <td>{{ cliente.telefone if cliente.telefone else '-' }}</td>
                    <td>{{ cliente.email if cliente.email else '-' }}</td>
                    <td>{{ cliente.data_cadastro|to_date }}</td>
                    <td class="table-actions">
                        <a href="{{ url_for('cliente_edicao', cliente_id=cliente.id) }}" class="btn btn-sm btn-warning" title="Editar">
                            <i class="fas fa-edit"></i>
                        </a>
                        <a href="{{ url_for('servicos_filtros', cliente=cliente.id) }}" class="btn btn-sm btn-info" title="Ver Serviços">
                            <i class="fas fa-file-alt"></i>
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="alert alert-info text-center" role="alert">
        Nenhum cliente cadastrado no momento.
    </div>
    {% endif %}
</div>
{% endblock %}
